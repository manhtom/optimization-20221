import math
import time

'''
n = 20
eld=[[0, 0, 0], [0, 162, 0], [126, 298, 0], [0, 102, 0], [22, 244, 0], [53, 231, 0], [0, 95, 0], [72, 241, 0], [0, 205, 0], [0, 130, 0], [0, 134, 0], [113, 326, 0], [11, 181, 0], [0, 167, 0], [18, 239, 0], [58, 234, 0], [0, 170, 0], [227, 381, 0], [127, 377, 0], [0, 168, 0], [233, 377, 0]]
lb=[0, 0, 126, 0, 22, 53, 0, 72, 0, 0, 0, 113, 11, 0, 18, 58, 0, 227, 127, 0, 233]
ub=[0, 162, 298, 102, 244, 231, 95, 241, 205, 130, 134, 326, 181, 167, 239, 234, 170, 381, 377, 168, 377]
d=[[0, 22, 30, 2, 16, 13, 9, 21, 23, 7, 10, 26, 19, 17, 20, 16, 29, 20, 20, 24, 22], [22, 0, 27, 23, 37, 27, 19, 36, 1, 15, 13, 11, 34, 12, 34, 26, 16, 22, 36, 6, 16], [30, 27, 0, 29, 45, 43, 35, 51, 28, 25, 22, 17, 49, 35, 50, 17, 43, 10, 50, 21, 11], [2, 23, 29, 0, 16, 14, 11, 22, 24, 8, 11, 27, 20, 19, 21, 14, 31, 19, 21, 25, 21], [16, 37, 45, 16, 0, 11, 18, 10, 38, 23, 26, 42, 9, 28, 11, 29, 38, 35, 8, 40, 37], [13, 27, 43, 14, 11, 0, 8, 9, 28, 18, 21, 36, 7, 18, 7, 28, 27, 33, 9, 32, 33], [9, 19, 35, 11, 18, 8, 0, 17, 20, 11, 13, 28, 15, 10, 15, 25, 21, 26, 17, 24, 25], [21, 36, 51, 22, 10, 9, 17, 0, 37, 27, 30, 45, 2, 26, 3, 36, 35, 41, 2, 41, 42], [23, 1, 28, 24, 38, 28, 20, 37, 0, 16, 14, 12, 35, 12, 35, 27, 15, 23, 37, 7, 17], [7, 15, 25, 8, 23, 18, 11, 27, 16, 0, 3, 19, 25, 14, 25, 14, 25, 15, 27, 17, 15], [10, 13, 22, 11, 26, 21, 13, 30, 14, 3, 0, 16, 28, 14, 28, 14, 25, 14, 30, 14, 12], [26, 11, 17, 27, 42, 36, 28, 45, 12, 19, 16, 0, 43, 22, 43, 24, 27, 17, 45, 5, 9], [19, 34, 49, 20, 9, 7, 15, 2, 35, 25, 28, 43, 0, 24, 2, 34, 33, 39, 3, 39, 40], [17, 12, 35, 19, 28, 18, 10, 26, 12, 14, 14, 22, 24, 0, 24, 28, 12, 28, 27, 17, 24], [20, 34, 50, 21, 11, 7, 15, 3, 35, 25, 28, 43, 2, 24, 0, 35, 32, 40, 5, 39, 40], [16, 26, 17, 14, 29, 28, 25, 36, 27, 14, 14, 24, 34, 28, 35, 0, 39, 8, 35, 24, 15], [29, 16, 43, 31, 38, 27, 21, 35, 15, 25, 25, 27, 33, 12, 32, 39, 0, 37, 36, 22, 32], [20, 22, 10, 19, 35, 33, 26, 41, 23, 15, 14, 17, 39, 28, 40, 8, 37, 0, 40, 19, 8], [20, 36, 50, 21, 8, 9, 17, 2, 37, 27, 30, 45, 3, 27, 5, 35, 36, 40, 0, 41, 42], [24, 6, 21, 25, 40, 32, 24, 41, 7, 17, 14, 5, 39, 17, 39, 24, 22, 19, 41, 0, 11], [22, 16, 11, 21, 37, 33, 25, 42, 17, 15, 12, 9, 40, 24, 40, 15, 32, 8, 42, 11, 0]]
'''
n = int(input()) #input number of customer
ub=[0] ##upper bound
lb=[0] ##lower bound
eld=[[0,0,0]]

for _ in range(n):
    temp=[int(x) for x in input().split()]
    eld.append(temp)
    lb.append(temp[0]) 
    ub.append(temp[1])

d = [[int(x) for x in input().split()] for i in range(n+1)] #input travel time array

node = [0]*(n+1)
current_time = [0]*(n+1)
m = [False]*(n+1)

solutions = [] 
times = []
def solu():
	solutions.append(node[1:])
	times.append(current_time[n])

def check(v, k):
	if current_time[k-1] + d[node[k-1]][v] <= ub[v] and m[v] == False: return True
	else: return False

def TRY(k):
	for v in range(1, n+1):
		if check(v, k):
			node[k] = v
			current_time[k] = current_time[k-1] + max(d[node[k-1]][v], lb[v]-current_time[k-1]) + eld[v][2]
			m[v] = True
			if k == n: solu()
			else: TRY(k+1)
			m[v] = False

print(n)
#st = time.time()
TRY(1)
min_time = math.inf

for tim in times:
	if tim <= min_time: 
		min_time = tim

result = list(solutions[times.index(min_time)])

#print("{0:.5f} s".format(time.time()-st))

for i in result: print(i, end = " ")
